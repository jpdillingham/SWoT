matrix:
  include:
    - language: node_js
      node_js:
        - "stable"
      before_script:
        - cd web
        - npm install
      cache:
        directories:
        - web/node_modules
      script:
        - npm test
        - npm run build
      deploy:
        provider: s3
        access_key_id: AKIAIAMHE73TSFTKF4SQ
        secret_access_key:
          secure: JuDtxp4QZnXMda0uaRhZMJsVGMFyzjmnraNJGkFR+uqO9EsJxmxAnc1KEu71AwUgnjbsnBmreq9VGJ4JZc0B89QMgSbdJDrWTd1YE79mc+01dUHcBsVtJ5dIB+00nnq9PvNe0CGDqd73tVBpyrJzY1ArWxqHP3SSysX9xOVQm3gTGhQQyc1AKS8KP2MkPyLI9BhgbGw4A3e0TYc7ZuZJkzjKIuj4Aay3xQ5XNB6MM/U7iS3Hi3t++88CtEgWkbLexcIHJ9h+ckoP2WtMdaonFLZyUdAE12+CMeQQm/3fPDCrbfRlhme9L3ZipXyHi/smQM1Fun9yBCsXXT4h3AfQSuYb1+PhL55vdAcseP21yZkxnTL27RQONy4YHyc7YTXJliJ2MdjrKXkJvH12x/+Y+KSeet+SPGM3m5T0u3bhAYNqUk9V65g6KrCmPEfDOlN8ej+kdYF1emspoBlNTHRlVNYGfvG99dRAwYotEM57MFYHSbjhE2fWf8j0mtSNtNnOzsUR005IGruFCXGqZsN88Yp4jhBwJ0afi1AAaEaGBiFF9XxgBKreCBE53mql0dxuG5Ukeysv5DjxyByo4r5v4dNlT16mk9jLxln+Ze4lPFSn9se8uAmRYp07HbRzr0W6tuEbL2W3cuXrNIXBhepQVpHjeBuQ0iFNi4UQroXsACQ=
        bucket: swot-content
        skip_cleanup: true
        local_dir: build
        region: us-east-1
        acl: public_read
        on:
          repo: jpdillingham/SWoT
          branch: master
    - language: node_js
      node_js:
        - stable
      before_script:
        - cd api
        - npm install
      cache:
        directories:
          - api/node_modules
      script:
        - npm test
      before_deploy:
        - npm run clean-modules
      deploy:
        provider: lambda
        function_name: SWoT
        region: us-east-1
        role: arn:aws:iam::578324725290:role/service-role/lambdarole
        runtime: nodejs6.10
        module_name: src/index
        handler_name: handler
        access_key_id: AKIAISVZZFCRHSNRRK7Q
        secret_access_key:
          secure: efVu/IuMbWy212is1ChPUgz0RMONA03pzBE/k1Ukbz+uYHVahOsjnpR9BhA16hEYiEgGLqUgZOi0T3uyJxbAi1JxtMga/SH8w6w4UWj28j1bOWtJSkU6OaRl9kA+ryMT6OcybUk3kexkwbN5o2yfnDNhoVtp8Cs1iIt4d6pEoSQ8KEu4yDN8DelMaX4ipBFp+251wo1oNQ9c37rJd0q/pzgGkH0bURIG7o45VS9Nkisr3MY1n1RKrMlNGagnTVfwGy9KjsA2b894m61h4/MZt73u1H9L6biWNqU5E9t162KiTfWiFTJVllMO6rvZCt3VCRGP09MQeIiQtTgIB9RXMFqvCR/uiVytFMn6vsBPUE/g3BFPftqbffNoXri7EXqTW1/HGQ/EXdGxC+WQOoqQxjK5CTAn7tlFt35mDSybRy8RKLI5VYGCCucjcBIzagdr0MyCh/1m6bbyC46aWHpugUU4uZx8/EsVF0fzXiRbb3Kd1/o57hZ0p0yg2Yxtt2FXQpzGUzltCH91tyQoSdgE+CFSikoHnKgvL8MbY4HOmspM1d04hLY9s3E4157Kk+ntrzcUNXMcWkWBFQ7hvrviJFMC01iE5Vn2SgPvVbAp5rpyZcHpbHvR6T6onq4qmg/vdZmNrQgqwuYGY/3wf/8ExhkdyXeYkuYkFIta1RDqmSA=
        on:
          repo: jpdillingham/SWoT
          branch: master
